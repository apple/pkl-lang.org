<!DOCTYPE html>
<html>
  <head>
    <title>Parser (pkg.pkl-lang.org/pkl-pantry/pkl.lua:1.1.0) • Packages</title>
    <script src="../../../../../scripts/pkldoc.js" defer="defer"></script>
    <script src="../../../../../scripts/scroll-into-view.min.js" defer="defer"></script>
    <script src="../../../../../data/pkg.pkl-lang.org/pkl-pantry/pkl.lua/1.1.0/lua/Parser.js" defer="defer"></script>
    <link href="../../../../../styles/pkldoc.css" media="screen" type="text/css" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="../../../../../images/favicon.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../../images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../../images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../../images/favicon-16x16.png">
    <meta charset="UTF-8">
  </head>
  <body onload="onLoad()">
    <header>
      <div id="doc-title"><a href="../../../../../index.html">Packages</a></div>
      <div id="search"><i id="search-icon" class="material-icons">search</i><input id="search-input" type="search" placeholder="Click or press 'S' to search this package" autocomplete="off" data-package-name="pkg.pkl-lang.org/pkl-pantry/pkl.lua" data-package-version="1.1.0" data-package-url-prefix="../" data-module-name="pkl.lua.lua" data-class-name="Parser" data-root-url-prefix="../../../../../"></div>
    </header>
    <main><a class="declaration-parent-link" href="../../../../../index.html">Packages</a> &gt; <a class="declaration-parent-link" href="../index.html">pkg.pkl-lang.org/pkl-pantry/pkl.lua</a> &gt; <a class="declaration-parent-link" href="index.html">pkl.lua.lua</a>
      <h1 id="declaration-title">Parser<span id="declaration-version">1.1.0</span></h1>
      <ul class="member-group-links">
        <li><a href="#_overview">Overview</a></li>
        <li><a href="#_properties">Properties</a></li>
        <li><a href="#_methods">Methods</a></li>
      </ul>
      <div id="_overview" class="anchor"> </div>
      <div id="_declaration" class="member with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i>
        <div class="member-signature">class <span class="name-decl">Parser</span></div>
        <div class="doc-comment"><p>A parser for a strict subset of Lua.</p></div>
        <dl class="member-info">
          <dt class="runtime-data hidden">Known subtypes:</dt>
          <dd id="known-subtypes" class="runtime-data hidden"></dd>
          <dt class="runtime-data hidden">Known usages:</dt>
          <dd id="known-usages" class="runtime-data hidden"></dd>
          <dt class="runtime-data hidden">All versions:</dt>
          <dd id="known-versions" class="runtime-data hidden"></dd>
        </dl>
        <div class="doc-comment expandable hidden collapsed"><p>This parser can handle Lua files that consist of comments and <code>key=value</code> lines, where the key is a Lua identifier
and the value is a literal string, number, boolean, <code>nil</code>, or table. Expressions are not supported. At the top level
the key cannot be the identifier <code>_ENV</code> unless it is followed by a subscript expression, as in <code>_ENV[key]=value</code>.
An <code>_ENV</code> subscript like this allows the top-level to contain keys that are not Lua identifiers.</p>
<p>When parsing nested tables, tables using key/value syntax (<code>{ [key] = value; … }</code>) will be parsed as list elements
if the key is integral and equal to the next unused index, otherwise they will be treated as map entries. Be aware
that the order of keys is important here; <code>{ [0] = &quot;a&quot;; [1] = &quot;b&quot;; [2] = &quot;c&quot; }</code> will be parsed as a list whereas
<code>{ [2] = &quot;c&quot;; [1] = &quot;b&quot;; [0] = &quot;a&quot; }</code> will be parsed as a map despite being equivalent Lua tables. See <a href="Parser.html#useDynamic"><code>useDynamic</code></a>
for details on the type used to represent nested tables.</p>
<p>When parsing <code>_ENV[key]=value</code> statements at the top-level, if the subscript key is an integral value and
<code>useDynamic</code> is <code>true</code> then it will be parsed as a list element in the same fashion as nested tables. However if
<code>useDynamic</code> is <code>false</code> then integral keys will not be treated any differently than other keys.</p>
<p>Lua values are mapped to Pkl values as follows:</p>
<table>
<thead>
<tr>
<th><strong>Lua type</strong></th>
<th><strong>Pkl type</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>nil</td>
<td><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Null.html"><code>Null</code></a></td>
</tr>
<tr>
<td>boolean</td>
<td><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Boolean.html"><code>Boolean</code></a></td>
</tr>
<tr>
<td>number</td>
<td><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Number.html"><code>Number</code></a></td>
</tr>
<tr>
<td>string</td>
<td><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html"><code>String</code></a></td>
</tr>
<tr>
<td>table</td>
<td><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html"><code>Dynamic</code></a> or <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Mapping.html"><code>Mapping</code></a>/<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Listing.html"><code>Listing</code></a> depending on <code>Parser.useDynamic</code></td>
</tr>
</tbody>
</table>
<h1>Example</h1>
<p>This is a sample Lua file that can be parsed with this Parser.</p>
<pre><code class="language-lua">--[[
This file has a header comment.
]]
foo=&quot;bar&quot;
count=2
-- line comment here
enable=true
frob=nil
ports={80, 443}
ips={
  localhost = &quot;127.0.0.1&quot;;
  [&quot;example.com&quot;] = &quot;93.184.215.14&quot;;
}
_ENV[&quot; &quot;]=&quot;space&quot;
</code></pre></div>
      </div>
      <div class="member-group">
        <div id="_properties" class="anchor"> </div>
        <h2 class="member-group-title">Properties</h2>
        <ul>
          <li>
            <div id="useDynamic" class="anchor"> </div>
            <div class="member with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#useDynamic">link</a>
              <div class="member-left">
                <div class="member-modifiers"></div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="name-decl">useDynamic</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Boolean.html" class="name-ref">Boolean</a><a class="member-source-link" href="https://github.com/apple/pkl-pantry/blob/pkl.lua@1.1.0/packages/pkl.lua/lua.pkl#L395-395">Source</a></div>
                <div class="doc-comment"><p>Determines what the parser produces when parsing Lua.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>If <code>true</code> (the default), the parse result is a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html"><code>Dynamic</code></a>, otherwise it's a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Mapping.html"><code>Mapping</code></a>.</p>
<p>For nested tables, if <code>true</code> every nested table is a <code>Dynamic</code>, otherwise a nested table will be a <code>Mapping</code> if it
contains key/value pairs, a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Listing.html"><code>Listing</code></a> if it contains elements, or it will throw an error if it contains both. If
<code>false</code> then empty tables will be represented as empty <code>Listing</code>s.</p>
<p>If <code>useDynamic</code> is <code>true</code>, Lua keys named &quot;default&quot; will be shadowed by the built-in <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html#default"><code>Dynamic.default</code></a> property.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="converters" class="anchor"> </div>
            <div class="member with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#converters">link</a>
              <div class="member-left">
                <div class="member-modifiers"></div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="name-decl">converters</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Mapping.html" class="name-ref">Mapping</a>&lt;(<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Class.html" class="name-ref">Class</a>|<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>), (unknown) -&gt; <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Any.html" class="name-ref">Any</a>&gt;<a class="member-source-link" href="https://github.com/apple/pkl-pantry/blob/pkl.lua@1.1.0/packages/pkl.lua/lua.pkl#L401-401">Source</a></div>
                <div class="doc-comment"><p>Value converters to apply to parsed values.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>For further information see <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/ValueRenderer.html#converters"><code>ValueRenderer.converters</code></a>. Table entries with string keys are treated as properties.
This means paths like <code>x[foo]</code> will never match anything.</p></div>
              </div>
            </div>
          </li>
        </ul>
      </div>
      <div class="member-group">
        <div id="_methods" class="anchor"> </div>
        <h2 class="member-group-title">Methods<span class="toggle-inherited-members">(<span class="toggle-inherited-members-link button-link">show inherited</span>)</span></h2>
        <ul>
          <li>
            <div id="getClass%28%29" class="anchor"> </div>
            <div class="member inherited expandable hidden collapsed"><a class="member-selflink material-icons" href="#getClass%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Any.html" class="name-ref">Any</a>.</span><span class="name-decl">getClass</span>(): <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Class.html" class="name-ref">Class</a><span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L43-L43">Source</a></div>
                <div class="doc-comment"><p>Returns the class of <code>this</code>.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="toString%28%29" class="anchor"> </div>
            <div class="member inherited expandable hidden collapsed with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#toString%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Any.html" class="name-ref">Any</a>.</span><span class="name-decl">toString</span>(): <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a><span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L48-L48">Source</a></div>
                <div class="doc-comment"><p>Returns a string representation of <code>this</code>.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>This method is used to convert the values of string interpolation expressions to strings.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="ifNonNull%28%29" class="anchor"> </div>
            <div id="ifNonNull%28%29.Result" class="anchor-param1"> </div>
            <div id="ifNonNull%28%29.transform" class="anchor-param2"> </div>
            <div class="member inherited expandable hidden collapsed with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#ifNonNull%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Any.html" class="name-ref">Any</a>.</span><span class="name-decl">ifNonNull</span>&lt;<a class="param1">Result</a>&gt;(<span class="param2">transform</span>: (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html#NonNull" class="name-ref">NonNull</a>) -&gt; <a href="Parser.html#ifNonNull().Result" class="name-ref">Result</a>): <a href="Parser.html#ifNonNull().Result" class="name-ref">Result</a>?<span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L53-L53">Source</a></div>
                <div class="doc-comment"><p>Returns <code>this |&gt; transform</code> if <code>this</code> is non-null, and <code>null</code> otherwise.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>This method is the complement of the <code>??</code> operator and the equivalent of an <code>Option</code> type's <code>map</code> and <code>flatMap</code> methods.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="hasProperty%28%29" class="anchor"> </div>
            <div id="hasProperty%28%29.name" class="anchor-param1"> </div>
            <div class="member inherited expandable hidden collapsed"><a class="member-selflink material-icons" href="#hasProperty%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Typed.html" class="name-ref">Typed</a>.</span><span class="name-decl">hasProperty</span>(<span class="param1">name</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>): <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Boolean.html" class="name-ref">Boolean</a><span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L1702-L1702">Source</a></div>
                <div class="doc-comment"><p>Tells if this object has a property with the given <code>name</code>.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="getProperty%28%29" class="anchor"> </div>
            <div id="getProperty%28%29.name" class="anchor-param1"> </div>
            <div class="member inherited expandable hidden collapsed with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#getProperty%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Typed.html" class="name-ref">Typed</a>.</span><span class="name-decl">getProperty</span>(<span class="param1">name</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>): unknown<span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L1707-L1707">Source</a></div>
                <div class="doc-comment"><p>Returns the value of the property with the given <code>name</code>.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>Throws if a property with this name does not exist.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="getPropertyOrNull%28%29" class="anchor"> </div>
            <div id="getPropertyOrNull%28%29.name" class="anchor-param1"> </div>
            <div class="member inherited expandable hidden collapsed with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#getPropertyOrNull%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Typed.html" class="name-ref">Typed</a>.</span><span class="name-decl">getPropertyOrNull</span>(<span class="param1">name</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>): unknown?<span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L1712-L1712">Source</a></div>
                <div class="doc-comment"><p>Returns the value of the property with the given <code>name</code>.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>Returns <code>null</code> if a property with this name does not exist.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="toDynamic%28%29" class="anchor"> </div>
            <div class="member inherited expandable hidden collapsed"><a class="member-selflink material-icons" href="#toDynamic%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Typed.html" class="name-ref">Typed</a>.</span><span class="name-decl">toDynamic</span>(): <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html" class="name-ref">Dynamic</a><span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L1715-L1715">Source</a></div>
                <div class="doc-comment"><p>Converts this object to a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html"><code>Dynamic</code></a> object.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="toMap%28%29" class="anchor"> </div>
            <div class="member inherited expandable hidden collapsed"><a class="member-selflink material-icons" href="#toMap%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="context"><a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Typed.html" class="name-ref">Typed</a>.</span><span class="name-decl">toMap</span>(): <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Map.html" class="name-ref">Map</a>&lt;<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>, unknown&gt;<span class="context"> (<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/index.html" class="name-ref">pkl.base</a>)</span><a class="member-source-link" href="https://github.com/apple/pkl/blob/0.25.3/stdlib/base.pkl#L1718-L1718">Source</a></div>
                <div class="doc-comment"><p>Converts this object to a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Map.html"><code>Map</code></a>.</p></div>
              </div>
            </div>
          </li>
          <li>
            <div id="parse%28%29" class="anchor"> </div>
            <div id="parse%28%29.source" class="anchor-param1"> </div>
            <div class="member with-expandable-docs"><i class="material-icons expandable-docs-icon">expand_more</i><a class="member-selflink material-icons" href="#parse%28%29">link</a>
              <div class="member-left">
                <div class="member-modifiers">function </div>
              </div>
              <div class="member-main">
                <div class="member-signature"><span class="name-decl">parse</span>(<span class="param1">source</span>: <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Resource.html" class="name-ref">Resource</a>|<a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/String.html" class="name-ref">String</a>): unknown<a class="member-source-link" href="https://github.com/apple/pkl-pantry/blob/pkl.lua@1.1.0/packages/pkl.lua/lua.pkl#L412-532">Source</a></div>
                <div class="doc-comment"><p>Parses <code>source</code> as a strict subset of Lua.</p></div>
                <div class="doc-comment expandable hidden collapsed"><p>Throws if an error occurs during parsing.</p>
<p>If <code>source</code> is a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Resource.html"><code>Resource</code></a>, the resource URI is included in parse error messages.</p>
<p>In the absence of converters this will return a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Dynamic.html"><code>Dynamic</code></a> or a <a href="https://pkl-lang.org/package-docs/pkl/0.25.3/base/Mapping.html">Mapping&lt;String, Value&gt;</a>.</p></div>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </main>
  </body>
</html>
